<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
    <link rel="stylesheet" href="/notes/main.css" />
    <title>Plotting 2D surfaces in python</title>
  </head>

  <body>
    <main><h1 id="Plotting-2D-surfaces-in-python">Plotting 2D surfaces in python</h1><p>Here&#x27;s a straightforward approach to plotting 2D surfaces in <code class="inline code">python</code>:</p><pre><code class="block code"><span class="keyword">import</span><span class="space"> </span><span class="name">numpy</span><span class="space"> </span><span class="keyword">as</span><span class="space"> </span><span class="name">np</span><span class="line">
</span><span class="keyword">import</span><span class="space"> </span><span class="name">matplotlib</span><span class="unknown">.</span><span class="name">pyplot</span><span class="space"> </span><span class="keyword">as</span><span class="space"> </span><span class="name">plt</span><span class="line">


</span><span class="comment"># Define the function to plot.</span><span class="line">
</span><span class="keyword">def</span><span class="space"> </span><span class="name">f</span><span class="punct">(</span><span class="name">x</span><span class="unknown">,</span><span class="space"> </span><span class="name">y</span><span class="punct">)</span><span class="unknown">:</span><span class="line">
</span><span class="space">    </span><span class="keyword">return</span><span class="space"> </span><span class="name">x</span><span class="space"> </span><span class="op">*</span><span class="space"> </span><span class="name">y</span><span class="line">


</span><span class="comment"># Define the domain.</span><span class="line">
</span><span class="name">x</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">np</span><span class="unknown">.</span><span class="name">linspace</span><span class="punct">(</span><span class="op">-</span><span class="number">2</span><span class="unknown">,</span><span class="space"> </span><span class="number">2</span><span class="unknown">,</span><span class="space"> </span><span class="number">50</span><span class="punct">)</span><span class="line">
</span><span class="name">y</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">np</span><span class="unknown">.</span><span class="name">linspace</span><span class="punct">(</span><span class="op">-</span><span class="number">2</span><span class="unknown">,</span><span class="space"> </span><span class="number">2</span><span class="unknown">,</span><span class="space"> </span><span class="number">50</span><span class="punct">)</span><span class="line">
</span><span class="name">X</span><span class="unknown">,</span><span class="space"> </span><span class="name">Y</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">np</span><span class="unknown">.</span><span class="name">meshgrid</span><span class="punct">(</span><span class="name">x</span><span class="unknown">,</span><span class="space"> </span><span class="name">y</span><span class="punct">)</span><span class="line">

</span><span class="comment"># Evaluate the function at each point in the domain.</span><span class="line">
</span><span class="name">Z</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">f</span><span class="punct">(</span><span class="name">X</span><span class="unknown">,</span><span class="space"> </span><span class="name">Y</span><span class="punct">)</span><span class="line">

</span><span class="name">fig</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">plt</span><span class="unknown">.</span><span class="name">figure</span><span class="punct">(</span><span class="punct">)</span><span class="line">
</span><span class="name">ax</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">fig</span><span class="unknown">.</span><span class="name">add_subplot</span><span class="punct">(</span><span class="number">111</span><span class="unknown">,</span><span class="space"> </span><span class="name">projection</span><span class="punct">=</span><span class="string">&quot;3d</span><span class="string">&quot;)</span><span class="line">

</span><span class="name">surf</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">ax</span><span class="unknown">.</span><span class="name">plot_surface</span><span class="punct">(</span><span class="name">X</span><span class="unknown">,</span><span class="space"> </span><span class="name">Y</span><span class="unknown">,</span><span class="space"> </span><span class="name">Z</span><span class="unknown">,</span><span class="space"> </span><span class="name">cmap</span><span class="punct">=</span><span class="string">&quot;hot</span><span class="string">&quot;)</span><span class="line">

</span><span class="name">plt</span><span class="unknown">.</span><span class="name">show</span><span class="punct">(</span><span class="punct">)</span></code></pre><p><img src="./2d-plot-1.png" alt="A plot of the function x * y"/></p><h2 id="Notes">Notes</h2><p>For piecewise functions like</p><div class="block math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>x</mi><mo>=</mo><mn>0</mn><mtext> or </mtext><mi>y</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mi>y</mi></mrow><mrow><msup><mi>x</mi><mn>4</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> otherwise </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f(x, y) =
\begin{cases}
0 &amp;\textrm{ if } x = 0 \textrm{ or } y = 0 \\
\frac{x^2y}{x^4 + y^2} &amp;\textrm{ otherwise }
\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7456em;"><span style="top:-3.8076em;"><span class="pstrut" style="height:3.07em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.3056em;"><span class="pstrut" style="height:3.07em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.07em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2456em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7456em;"><span style="top:-3.8076em;"><span class="pstrut" style="height:3.07em;"></span><span class="mord"><span class="mord text"><span class="mord textrm"> if </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span><span class="mord text"><span class="mord textrm"> or </span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.3056em;"><span class="pstrut" style="height:3.07em;"></span><span class="mord"><span class="mord text"><span class="mord textrm"> otherwise </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2456em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><p>the straightforward transliteration into <code class="inline code">python</code> doesn&#x27;t work:</p><pre><code class="block code"><span class="keyword">def</span><span class="space"> </span><span class="name">f</span><span class="punct">(</span><span class="name">x</span><span class="unknown">,</span><span class="space"> </span><span class="name">y</span><span class="punct">)</span><span class="unknown">:</span><span class="line">
</span><span class="space">    </span><span class="keyword">if</span><span class="space"> </span><span class="name">x</span><span class="space"> </span><span class="punct">=</span><span class="punct">=</span><span class="space"> </span><span class="number">0</span><span class="space"> </span><span class="keyword">or</span><span class="space"> </span><span class="name">y</span><span class="space"> </span><span class="punct">=</span><span class="punct">=</span><span class="space"> </span><span class="number">0</span><span class="unknown">:</span><span class="line">
</span><span class="space">        </span><span class="keyword">return</span><span class="space"> </span><span class="number">0</span><span class="line">
</span><span class="space">    </span><span class="keyword">else</span><span class="unknown">:</span><span class="line">
</span><span class="space">        </span><span class="keyword">return</span><span class="space"> </span><span class="punct">(</span><span class="name">x</span><span class="op">*</span><span class="op">*</span><span class="number">2</span><span class="space"> </span><span class="op">*</span><span class="space"> </span><span class="name">y</span><span class="punct">)</span><span class="space"> </span><span class="unknown">/</span><span class="space"> </span><span class="punct">(</span><span class="name">x</span><span class="op">*</span><span class="op">*</span><span class="number">4</span><span class="space"> </span><span class="op">+</span><span class="space"> </span><span class="name">y</span><span class="op">*</span><span class="op">*</span><span class="number">2</span><span class="punct">)</span></code></pre><p>instead inciting the error:</p><pre><code class="block code">ValueError: The truth value of an array with more than one element
is ambiguous. Use a.any() or a.all()</code></pre><p>This refers to the fact that <code class="inline code">x</code> and <code class="inline code">y</code> in <code class="inline code">f</code> are not scalars but <code class="inline code">numpy</code>
arrays.
Because of this, <code class="inline code">x == 0</code> doesn&#x27;t make sense.
We have at least two options here:</p><ol><li><p>“<!-- -->Vectorize<!-- -->”<!-- --> the function:</p><pre><code class="block code"><span class="name">F</span><span class="space"> </span><span class="punct">=</span><span class="space"> </span><span class="name">np</span><span class="unknown">.</span><span class="name">vectorize</span><span class="punct">(</span><span class="name">f</span><span class="punct">)</span></code></pre></li><li><p>Rewrite it (if possible) using <code class="inline code">np.where</code>:</p><pre><code class="block code"><span class="keyword">def</span><span class="space"> </span><span class="name">f</span><span class="punct">(</span><span class="name">x</span><span class="unknown">,</span><span class="space"> </span><span class="name">y</span><span class="punct">)</span><span class="unknown">:</span><span class="line">
</span><span class="space">    </span><span class="keyword">return</span><span class="space"> </span><span class="name">np</span><span class="unknown">.</span><span class="name">where</span><span class="punct">(</span><span class="punct">(</span><span class="name">x</span><span class="space"> </span><span class="punct">=</span><span class="punct">=</span><span class="space"> </span><span class="number">0</span><span class="punct">)</span><span class="space"> </span><span class="unknown">|</span><span class="space"> </span><span class="punct">(</span><span class="name">y</span><span class="space"> </span><span class="punct">=</span><span class="punct">=</span><span class="space"> </span><span class="number">0</span><span class="punct">)</span><span class="unknown">,</span><span class="space"> </span><span class="number">0</span><span class="unknown">,</span><span class="space"> </span><span class="punct">(</span><span class="name">x</span><span class="op">*</span><span class="op">*</span><span class="number">2</span><span class="space"> </span><span class="op">*</span><span class="space"> </span><span class="name">y</span><span class="punct">)</span><span class="space"> </span><span class="unknown">/</span><span class="space"> </span><span class="punct">(</span><span class="name">x</span><span class="op">*</span><span class="op">*</span><span class="number">4</span><span class="space"> </span><span class="op">+</span><span class="space"> </span><span class="name">y</span><span class="op">*</span><span class="op">*</span><span class="number">2</span><span class="punct">)</span><span class="punct">)</span></code></pre></li></ol><p>The result is the same:</p><p><img src="./2d-plot-2.png" alt="A plot of a piecewise function"/></p><div class="footnotes"></div></main>
  </body>
</html>